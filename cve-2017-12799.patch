From 957e1fc1c5d0262e4b2f764cf031ad1458446498 Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Thu, 10 Aug 2017 09:37:36 +0100
Subject: [PATCH] Fix out of bounds memory access when trying to allocate space
 for a note of size -1.

	PR 21933
	* elf.c (elf_read_notes): Check for a note size of -1.
---
 bfd/elf.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/bfd/elf.c b/bfd/elf.c
index bc4b4a3cd1..d702474bff 100644
--- a/bfd/elf.c
+++ b/bfd/elf.c
@@ -10997,7 +10997,7 @@ elf_read_notes (bfd *abfd, file_ptr offset, bfd_size_type size)
 {
   char *buf;
 
-  if (size <= 0)
+  if (size == 0 || (size + 1) == 0)
     return TRUE;
 
   if (bfd_seek (abfd, offset, SEEK_SET) != 0)
-- 
2.14.1

